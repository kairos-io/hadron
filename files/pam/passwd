# Use pam_unix directly, write to /etc/shadow, and use SHA-512 (widely available in initramfs)
# Keep 'obscure' if you want minimal built-in checks from pam_unix
password   [success=1 default=ignore]   pam_unix.so obscure yescrypt shadow nullok

# here's the fallback if no module succeeds
password   requisite                    pam_deny.so

# prime the stack with a positive return value if there isn't one already
password   required                     pam_permit.so